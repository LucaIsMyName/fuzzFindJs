(function(u,f){typeof exports=="object"&&typeof module<"u"?f(exports):typeof define=="function"&&define.amd?define(["exports"],f):(u=typeof globalThis<"u"?globalThis:u||self,f(u.FuzzyFindJS={}))})(this,(function(u){"use strict";const f={languages:["english"],features:["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters","transpositions"],performance:"balanced",maxResults:10,minQueryLength:2,fuzzyThreshold:.75,maxEditDistance:2,ngramSize:3},k={fast:{performance:"fast",features:["partial-words","missing-letters"],maxEditDistance:1,fuzzyThreshold:.9,maxResults:3},balanced:{performance:"balanced",features:["phonetic","partial-words","missing-letters","keyboard-neighbors"],maxEditDistance:2,fuzzyThreshold:.8,maxResults:5},comprehensive:{performance:"comprehensive",features:["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters","transpositions"],maxEditDistance:3,fuzzyThreshold:.7,maxResults:10}},z={german:["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"],english:["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","transpositions"],spanish:["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters"],french:["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters"]};function w(r={}){const n={...f};if(r.performance&&r.performance!=="balanced"){const e=k[r.performance];Object.assign(n,e)}const a={...n,...r};if(!r.features&&r.languages){const e=new Set;for(const s of r.languages)(z[s]||z.english).forEach(c=>e.add(c));a.features=Array.from(e)}return a}function R(r){if(r.maxResults<1)throw new Error("maxResults must be at least 1");if(r.minQueryLength<1)throw new Error("minQueryLength must be at least 1");if(r.fuzzyThreshold<0||r.fuzzyThreshold>1)throw new Error("fuzzyThreshold must be between 0 and 1");if(r.maxEditDistance<0)throw new Error("maxEditDistance must be non-negative");if(r.ngramSize<2)throw new Error("ngramSize must be at least 2");if(r.languages.length===0)throw new Error("At least one language must be specified")}class p{normalize(n){return n.toLowerCase().trim().replace(/\s+/g," ")}getPhoneticCode(n){const a=this.normalize(n);if(a.length===0)return"";let e=a[0].toUpperCase();const s={b:"1",f:"1",p:"1",v:"1",c:"2",g:"2",j:"2",k:"2",q:"2",s:"2",x:"2",z:"2",d:"3",t:"3",l:"4",m:"5",n:"5",r:"6"};for(let i=1;i<a.length&&e.length<4;i++){const c=a[i],t=s[c];t&&t!==e[e.length-1]&&(e+=t)}return e.padEnd(4,"0")}splitCompoundWords(n){return[n]}getWordVariants(n){const a=new Set,e=this.normalize(n);a.add(e),a.add(n);const s=this.getCommonEndings();for(const i of s)e.endsWith(i)&&e.length>i.length+2&&a.add(e.slice(0,-i.length));if(e.length>4)for(let i=3;i<e.length;i++)a.add(e.slice(0,i));return Array.from(a)}getCommonEndings(){return["s","es","ed","ing","er","est"]}getSynonyms(n){return[]}isValidSubstitution(n,a){const s=this.getKeyboardNeighbors()[n.toLowerCase()];return s?s.includes(a.toLowerCase()):!1}getKeyboardNeighbors(){return{q:["w","a","s"],w:["q","e","a","s","d"],e:["w","r","s","d","f"],r:["e","t","d","f","g"],t:["r","y","f","g","h"],y:["t","u","g","h","j"],u:["y","i","h","j","k"],i:["u","o","j","k","l"],o:["i","p","k","l"],p:["o","l"],a:["q","w","s","z","x"],s:["q","w","e","a","d","z","x","c"],d:["w","e","r","s","f","x","c","v"],f:["e","r","t","d","g","c","v","b"],g:["r","t","y","f","h","v","b","n"],h:["t","y","u","g","j","b","n","m"],j:["y","u","i","h","k","n","m"],k:["u","i","o","j","l","m"],l:["i","o","p","k"],z:["a","s","x"],x:["a","s","d","z","c"],c:["s","d","f","x","v"],v:["d","f","g","c","b"],b:["f","g","h","v","n"],n:["g","h","j","b","m"],m:["h","j","k","n"]}}generateNgrams(n,a=3){const e=this.normalize(n);if(e.length<a)return[e];const s=[];for(let i=0;i<=e.length-a;i++)s.push(e.slice(i,i+a));return s}calculateEditDistance(n,a){const e=[],s=n.length,i=a.length;for(let c=0;c<=s;c++)e[c]=[c];for(let c=0;c<=i;c++)e[0][c]=c;for(let c=1;c<=s;c++)for(let t=1;t<=i;t++){const o=n[c-1]===a[t-1]?0:1;e[c][t]=Math.min(e[c-1][t]+1,e[c][t-1]+1,e[c-1][t-1]+o)}return e[s][i]}}class v extends p{language="german";displayName="Deutsch";supportedFeatures=["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"];normalize(n){return n.toLowerCase().trim().replace(/\s+/g," ").replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss")}getPhoneticCode(n){const a=this.normalize(n);if(a.length===0)return"";let e="",s="";for(let i=0;i<a.length;i++){const c=a[i],t=i<a.length-1?a[i+1]:"";let o="";switch(c){case"a":case"e":case"i":case"j":case"o":case"u":case"y":o="0";break;case"h":continue;case"b":case"p":o="1";break;case"d":case"t":t==="c"||t==="s"||t==="z"?o="8":o="2";break;case"f":case"v":case"w":o="3";break;case"g":case"k":case"q":o="4";break;case"c":i===0?t==="a"||t==="h"||t==="k"||t==="l"||t==="o"||t==="q"||t==="r"||t==="u"||t==="x"?o="4":o="8":s==="s"||s==="z"?o="8":t==="h"||t==="k"||t==="q"?o="4":o="8";break;case"x":s==="c"||s==="k"||s==="q"?o="8":o="48";break;case"l":o="5";break;case"m":case"n":o="6";break;case"r":o="7";break;case"s":case"z":o="8";break;default:continue}o&&o!==s&&(e+=o),s=o}return e||"0"}splitCompoundWords(n){const a=this.normalize(n);if(a.length<6)return[n];const e=[],s=this.getCommonPrefixes(),i=this.getCommonSuffixes(),c=this.getCommonWords();for(const t of s)if(a.startsWith(t)&&a.length>t.length+3){const o=a.slice(t.length);e.push(t),e.push(...this.splitCompoundWords(o));break}if(e.length===0){for(const t of i)if(a.endsWith(t)&&a.length>t.length+3){const o=a.slice(0,-t.length);e.push(...this.splitCompoundWords(o)),e.push(t);break}}if(e.length===0)for(let t=3;t<=a.length-3;t++){const o=a.slice(0,t),l=a.slice(t);if(c.has(o)&&l.length>=3){e.push(o),e.push(...this.splitCompoundWords(l));break}}return e.length>0?e:[n]}getWordVariants(n){const a=new Set,e=this.normalize(n);a.add(e),a.add(n),this.splitCompoundWords(n).forEach(c=>a.add(this.normalize(c)));const i=this.getCommonEndings();for(const c of i)e.endsWith(c)&&e.length>c.length+2&&a.add(e.slice(0,-c.length));if(e.length>4)for(let c=3;c<e.length;c++)a.add(e.slice(0,c));return Array.from(a)}getCommonEndings(){return["en","e","er","n","r","s","es","t","ung","heit","keit","schaft","chen","lein","lich","ig","isch","bar","los","voll"]}getSynonyms(n){const a={arzt:["doktor","mediziner","doc"],krankenhaus:["spital","klinik","hospital"],schule:["bildungseinrichtung","lehranstalt"],auto:["wagen","fahrzeug","pkw"],haus:["gebaeude","heim","wohnhaus"],strasse:["weg","gasse","allee"],stadt:["ort","gemeinde","ortschaft"],arbeit:["job","beruf","taetigkeit"],geld:["waehrung","kapital","finanzen"],zeit:["dauer","periode","zeitraum"]},e=this.normalize(n);return a[e]||[]}getKeyboardNeighbors(){return{q:["w","a","s"],w:["q","e","a","s","d"],e:["w","r","s","d","f"],r:["e","t","d","f","g"],t:["r","z","f","g","h"],z:["t","u","g","h","j"],u:["z","i","h","j","k"],i:["u","o","j","k","l"],o:["i","p","k","l","oe"],p:["o","ue","l","oe"],ue:["p","ae"],a:["q","w","s","y","x"],s:["q","w","e","a","d","y","x","c"],d:["w","e","r","s","f","x","c","v"],f:["e","r","t","d","g","c","v","b"],g:["r","t","z","f","h","v","b","n"],h:["t","z","u","g","j","b","n","m"],j:["z","u","i","h","k","n","m"],k:["u","i","o","j","l","m"],l:["i","o","p","k","oe"],oe:["o","p","ue","l","ae"],ae:["ue","oe"],y:["a","s","x"],x:["a","s","d","y","c"],c:["s","d","f","x","v"],v:["d","f","g","c","b"],b:["f","g","h","v","n"],n:["g","h","j","b","m"],m:["h","j","k","n"]}}getCommonPrefixes(){return["un","vor","nach","bei","mit","ab","an","auf","aus","ein","gegen","hinter","neben","ueber","unter","zwischen","selbst"]}getCommonSuffixes(){return["haus","platz","strasse","weg","hof","berg","tal","feld","stadt","dorf","heim","werk","bau","anlage","zentrum"]}getCommonWords(){return new Set(["kranken","kinder","frauen","maenner","alt","neu","gross","klein","hoch","tief","lang","kurz","breit","schmal","dick","duenn","stark","schwach","schnell","langsam","heiss","kalt","warm","auto","bahn","bus","zug","flug","schiff","rad","motor","wasser","feuer","erde","luft","licht","schatten","sonne","mond","tag","nacht","morgen","abend","mittag","zeit","jahr","monat"])}}class x extends p{language="english";displayName="English";supportedFeatures=["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters","transpositions"];normalize(n){return n.toLowerCase().trim().replace(/\s+/g," ").replace(/won't/g,"will not").replace(/can't/g,"cannot").replace(/n't/g," not").replace(/'re/g," are").replace(/'ve/g," have").replace(/'ll/g," will").replace(/'d/g," would").replace(/'m/g," am").replace(/'/g,"")}getPhoneticCode(n){const a=this.normalize(n).replace(/[^a-z]/g,"");if(a.length===0)return"";let e="",s=0;const i=a.length;for((a.startsWith("gn")||a.startsWith("kn")||a.startsWith("pn")||a.startsWith("wr"))&&(s=1);s<i&&e.length<4;){const c=a[s],t=s+1<i?a[s+1]:"",o=s>0?a[s-1]:"";switch(c){case"a":case"e":case"i":case"o":case"u":s===0&&(e+=c.toUpperCase());break;case"b":s===i-1&&o==="m"||(e+="B");break;case"c":t==="h"?(e+="X",s++):t==="i"||t==="e"||t==="y"?e+="S":e+="K";break;case"d":t==="g"?(e+="J",s++):e+="T";break;case"f":e+="F";break;case"g":t==="h"&&s!==0||(t==="n"?(e+="N",s++):t==="i"||t==="e"||t==="y"?e+="J":e+="K");break;case"h":(s===0||"aeiou".includes(o)||"aeiou".includes(t))&&(e+="H");break;case"j":e+="J";break;case"k":o!=="c"&&(e+="K");break;case"l":e+="L";break;case"m":e+="M";break;case"n":e+="N";break;case"p":t==="h"?(e+="F",s++):e+="P";break;case"q":e+="K";break;case"r":e+="R";break;case"s":t==="h"?(e+="X",s++):e+="S";break;case"t":t==="h"?(e+="0",s++):t==="i"&&s+2<i&&(a[s+2]==="a"||a[s+2]==="o")?e+="X":e+="T";break;case"v":e+="F";break;case"w":"aeiou".includes(t)&&(e+="W");break;case"x":e+="KS";break;case"y":"aeiou".includes(t)&&(e+="Y");break;case"z":e+="S";break}s++}return e||"A"}getWordVariants(n){const a=new Set,e=this.normalize(n);a.add(e),a.add(n);const s=this.getCommonEndings();for(const i of s)e.endsWith(i)&&e.length>i.length+2&&a.add(e.slice(0,-i.length));if(e.endsWith("s")&&e.length>3&&a.add(e.slice(0,-1)),e.endsWith("s")||a.add(e+"s"),e.endsWith("ing")&&e.length>5){const i=e.slice(0,-3);a.add(i),a.add(i+"e")}if(e.endsWith("ed")&&e.length>4){const i=e.slice(0,-2);a.add(i),a.add(i+"e")}if(e.length>4)for(let i=3;i<e.length;i++)a.add(e.slice(0,i));return Array.from(a)}getCommonEndings(){return["s","es","ed","ing","er","est","ly","tion","sion","ness","ment","able","ible","ful","less","ous","ious","al","ial","ic","ive","ary","ery","ory"]}getSynonyms(n){const a={doctor:["physician","medic","doc","md"],hospital:["clinic","medical center","infirmary"],school:["academy","institution","college","university"],car:["vehicle","automobile","auto"],house:["home","residence","dwelling","building"],street:["road","avenue","lane","boulevard"],city:["town","municipality","urban area"],work:["job","employment","occupation","career"],money:["cash","currency","funds","capital"],time:["duration","period","moment","hour"],big:["large","huge","enormous","massive","giant"],small:["little","tiny","miniature","petite"],fast:["quick","rapid","speedy","swift"],slow:["sluggish","gradual","leisurely"],good:["excellent","great","wonderful","fine"],bad:["poor","terrible","awful","horrible"],happy:["joyful","cheerful","glad","pleased"],sad:["unhappy","depressed","melancholy","sorrowful"]},e=this.normalize(n);return a[e]||[]}}class S extends p{language="spanish";displayName="Español";supportedFeatures=["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"];normalize(n){return n.toLowerCase().trim().replace(/\s+/g," ").replace(/á/g,"a").replace(/é/g,"e").replace(/í/g,"i").replace(/ó/g,"o").replace(/ú/g,"u").replace(/ñ/g,"n").replace(/ü/g,"u")}getPhoneticCode(n){const a=this.normalize(n);if(a.length===0)return"";let e="",s="";for(let i=0;i<a.length;i++){const c=a[i],t=i<a.length-1?a[i+1]:"";let o="";switch(c){case"a":case"e":case"i":case"o":case"u":o="0";break;case"b":case"v":o="1";break;case"c":t==="h"?o="2":t==="e"||t==="i"?o="8":o="4";break;case"d":o="3";break;case"f":o="5";break;case"g":t==="u"&&i+2<a.length&&(a[i+2]==="e"||a[i+2]==="i")?o="4":t==="e"||t==="i"?o="6":o="4";break;case"h":continue;case"j":o="6";break;case"k":o="4";break;case"l":t==="l"?o="7":o="5";break;case"m":o="6";break;case"n":t==="n"?o="7":o="6";break;case"ñ":o="7";break;case"p":o="1";break;case"q":o="4";break;case"r":t==="r"||i===0?o="8":o="7";break;case"s":o="8";break;case"t":o="3";break;case"w":o="1";break;case"x":o="48";break;case"y":o="7";break;case"z":o="8";break;default:continue}o&&o!==s&&(e+=o),s=o}return e||"0"}getCommonEndings(){return["o","a","os","as","e","es","ar","er","ir","ado","ada","idos","idas","ando","endo","iendo","cion","sion","dad","tad","mente","oso","osa","ito","ita","illo","illa"]}getSynonyms(n){const a={medico:["doctor","facultativo"],hospital:["clinica","sanatorio"],escuela:["colegio","instituto"],coche:["auto","automovil","vehiculo"],casa:["hogar","vivienda","domicilio"],calle:["via","avenida","carretera"],ciudad:["urbe","poblacion","municipio"],trabajo:["empleo","ocupacion","labor"],dinero:["plata","efectivo","capital"],tiempo:["momento","periodo","duracion"],grande:["enorme","gigante","inmenso"],pequeno:["chico","diminuto","minusculo"],rapido:["veloz","ligero","acelerado"],lento:["despacio","pausado"],bueno:["excelente","magnifico","estupendo"],malo:["pesimo","terrible","horrible"]},e=this.normalize(n);return a[e]||[]}}class E extends p{language="french";displayName="Français";supportedFeatures=["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"];normalize(n){return n.toLowerCase().trim().replace(/\s+/g," ").replace(/[àáâãä]/g,"a").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/[òóôõö]/g,"o").replace(/[ùúûü]/g,"u").replace(/ç/g,"c").replace(/ñ/g,"n").replace(/ÿ/g,"y")}getPhoneticCode(n){const a=this.normalize(n);if(a.length===0)return"";let e="",s="";for(let i=0;i<a.length;i++){const c=a[i],t=i<a.length-1?a[i+1]:"",o=i<a.length-2?a[i+2]:"";let l="";switch(c){case"a":case"e":case"i":case"o":case"u":case"y":l="0";break;case"b":l="1";break;case"c":t==="h"?l="2":t==="e"||t==="i"?l="8":l="4";break;case"d":l="3";break;case"f":l="5";break;case"g":t==="n"?l="6":t==="u"&&(o==="e"||o==="i")?l="4":t==="e"||t==="i"?l="6":l="4";break;case"h":i===0&&(l="0");break;case"j":l="6";break;case"k":l="4";break;case"l":l="5";break;case"m":l="6";break;case"n":l="6";break;case"p":t==="h"?l="5":l="1";break;case"q":l="4";break;case"r":l="7";break;case"s":l="8";break;case"t":l="3";break;case"v":l="5";break;case"w":l="5";break;case"x":l="48";break;case"z":l="8";break;default:continue}l&&l!==s&&(e+=l),s=l}return e||"0"}getCommonEndings(){return["e","es","s","x","ent","ant","ment","tion","sion","eur","euse","teur","trice","able","ible","ique","aire","oire","ette","elle","esse","asse","isse","age","isme","iste","ite","ude","ade"]}getSynonyms(n){const a={medecin:["docteur","praticien"],hopital:["clinique","centre medical"],ecole:["etablissement","institution"],voiture:["automobile","vehicule","auto"],maison:["domicile","residence","habitation"],rue:["avenue","boulevard","voie"],ville:["cite","commune","agglomeration"],travail:["emploi","occupation","metier"],argent:["monnaie","especes","capital"],temps:["duree","periode","moment"],grand:["enorme","immense","gigantesque"],petit:["minuscule","minime","reduit"],rapide:["vite","accelere","prompt"],lent:["lentement","doucement"],bon:["excellent","parfait","formidable"],mauvais:["terrible","affreux","horrible"],heureux:["joyeux","content","ravi"],triste:["malheureux","chagrine","melancolique"]},e=this.normalize(n);return a[e]||[]}getKeyboardNeighbors(){return{a:["z","e","r","q","s"],z:["a","e","r","q","s","d"],e:["z","r","t","s","d","f"],r:["e","t","y","d","f","g"],t:["r","y","u","f","g","h"],y:["t","u","i","g","h","j"],u:["y","i","o","h","j","k"],i:["u","o","p","j","k","l"],o:["i","p","k","l","m"],p:["o","l","m"],q:["a","z","s","w","x"],s:["a","z","e","q","d","w","x","c"],d:["z","e","r","s","f","x","c","v"],f:["e","r","t","d","g","c","v","b"],g:["r","t","y","f","h","v","b","n"],h:["t","y","u","g","j","b","n"],j:["y","u","i","h","k","n"],k:["u","i","o","j","l"],l:["i","o","p","k","m"],m:["o","p","l"],w:["q","s","x"],x:["q","s","d","w","c"],c:["s","d","f","x","v"],v:["d","f","g","c","b"],b:["f","g","h","v","n"],n:["g","h","j","b"]}}}class C{static processors=new Map([["german",new v],["english",new x],["spanish",new S],["french",new E]]);static getProcessor(n){return this.processors.get(n.toLowerCase())}static getProcessors(n){return n.map(a=>this.getProcessor(a)).filter(a=>a!==void 0)}static getAvailableLanguages(){return Array.from(this.processors.keys())}static registerProcessor(n){this.processors.set(n.language.toLowerCase(),n)}static isSupported(n){return this.processors.has(n.toLowerCase())}static getProcessorInfo(){return Array.from(this.processors.values()).map(n=>({language:n.language,displayName:n.displayName,supportedFeatures:n.supportedFeatures}))}}function b(r,n,a=1/0){const e=r.length,s=n.length;if(Math.abs(e-s)>a)return a+1;if(e===0)return s;if(s===0)return e;if(r===n)return 0;let i=new Array(s+1),c=new Array(s+1);for(let t=0;t<=s;t++)i[t]=t;for(let t=1;t<=e;t++){c[0]=t;let o=t;for(let l=1;l<=s;l++){const g=r[t-1]===n[l-1]?0:1;c[l]=Math.min(c[l-1]+1,i[l]+1,i[l-1]+g),o=Math.min(o,c[l])}if(o>a)return a+1;[i,c]=[c,i]}return i[s]}function A(r,n,a=1/0){const e=r.length,s=n.length;if(Math.abs(e-s)>a)return a+1;if(e===0)return s;if(s===0)return e;if(r===n)return 0;const i=Math.max(e,s),c=[],t=i+1;for(let g=0;g<=e+1;g++)c[g]=new Array(s+2).fill(t);c[0][0]=t;for(let g=0;g<=e;g++)c[g+1][0]=t,c[g+1][1]=g;for(let g=0;g<=s;g++)c[0][g+1]=t,c[1][g+1]=g;const o=new Map;for(let g=1;g<=e;g++){let h=0;for(let m=1;m<=s;m++){const X=r[g-1],W=n[m-1],F=o.get(W)||0;let N=1;X===W&&(N=0,h=m),c[g+1][m+1]=Math.min(c[g][m]+N,c[g+1][m]+1,c[g][m+1]+1,c[F][h]+(g-F-1)+1+(m-h-1))}o.set(r[g-1],g)}const l=c[e+1][s+1];return l>a?a+1:l}function y(r,n,a=3){if(r===n)return 1;if(r.length===0||n.length===0)return 0;const e=M(r,a),s=M(n,a);if(e.length===0&&s.length===0)return 1;if(e.length===0||s.length===0)return 0;const i=new Set(e),c=new Set(s),t=new Set([...i].filter(l=>c.has(l))),o=new Set([...i,...c]);return t.size/o.size}function M(r,n){if(r.length<n)return[r];const a=[];for(let e=0;e<=r.length-n;e++)a.push(r.slice(e,e+n));return a}function P(r,n){return n===0?r===0?1:0:Math.max(0,1-r/n)}function q(r,n,a=.8,e=2){if(r===n)return!0;const s=Math.max(r.length,n.length);if(Math.abs(r.length-n.length)>e||y(r,n)<a-.2)return!1;const c=b(r,n,e);return P(c,s)>=a}function j(r=[],n={}){const a=w(n.config);R(a);const e=new Set(a.features),s=n.languageProcessors||C.getProcessors(a.languages);if(s.length===0)throw new Error(`No language processors found for: ${a.languages.join(", ")}`);const i={base:[],variantToBase:new Map,phoneticToBase:new Map,ngramIndex:new Map,synonymMap:new Map,languageProcessors:new Map,config:a};s.forEach(o=>{i.languageProcessors.set(o.language,o)});const c=new Set;let t=0;for(const o of r){if(!o||o.trim().length<a.minQueryLength)continue;const l=o.trim();if(!c.has(l.toLowerCase())){c.add(l.toLowerCase()),i.base.push(l);for(const g of s)D(l,g,i,a,e);t++,n.onProgress&&n.onProgress(t,r.length)}}return i}function D(r,n,a,e,s){const i=n.normalize(r);if(d(a.variantToBase,i,r),d(a.variantToBase,r.toLowerCase(),r),d(a.variantToBase,r,r),s.has("partial-words")&&n.getWordVariants(r).forEach(o=>{d(a.variantToBase,o,r)}),s.has("phonetic")&&n.supportedFeatures.includes("phonetic")){const t=n.getPhoneticCode(r);t&&d(a.phoneticToBase,t,r)}if(L(i,e.ngramSize).forEach(t=>{d(a.ngramIndex,t,r)}),s.has("compound")&&n.supportedFeatures.includes("compound")&&n.splitCompoundWords(r).forEach(o=>{o!==r&&d(a.variantToBase,n.normalize(o),r)}),s.has("synonyms")&&(n.getSynonyms(i).forEach(o=>{d(a.synonymMap,o,r)}),e.customSynonyms)){const o=e.customSynonyms[i];o&&o.forEach(l=>{d(a.synonymMap,l,r)})}}function d(r,n,a){r.has(n)||r.set(n,new Set),r.get(n).add(a)}function T(r,n,a,e={}){const s=r.config,i=a||e.maxResults||s.maxResults,c=e.fuzzyThreshold||s.fuzzyThreshold;if(!n||n.trim().length<s.minQueryLength)return[];const t=new Map,l=(e.languages||s.languages).map(h=>r.languageProcessors.get(h)).filter(h=>h!==void 0);if(l.length===0)return[];for(const h of l){const m=h.normalize(n.trim());I(m,r,t,h.language),B(m,r,t,h.language),O(m,h,r,t),K(m,r,t),G(m,r,t,h.language,s.ngramSize),(s.features.includes("missing-letters")||s.features.includes("extra-letters")||s.features.includes("transpositions"))&&V(m,r,t,h,s)}return Array.from(t.values()).map(h=>_(h,n,c)).filter(h=>h!==null).sort((h,m)=>m.score-h.score).slice(0,i)}function I(r,n,a,e){const s=n.variantToBase.get(r);s&&s.forEach(c=>{a.has(c)||a.set(c,{word:c,normalized:r,matchType:"exact",editDistance:0,language:e})});const i=r.toLowerCase();for(const c of n.base)c.toLowerCase()===i&&(a.has(c)||a.set(c,{word:c,normalized:r,matchType:"exact",editDistance:0,language:e}))}function B(r,n,a,e){for(const[s,i]of n.variantToBase.entries())s.startsWith(r)&&s!==r&&i.forEach(c=>{a.has(c)||a.set(c,{word:c,normalized:s,matchType:"prefix",language:e})})}function O(r,n,a,e){if(!n.supportedFeatures.includes("phonetic"))return;const s=n.getPhoneticCode(r);if(s){const i=a.phoneticToBase.get(s);i&&i.forEach(c=>{e.has(c)||e.set(c,{word:c,normalized:r,matchType:"phonetic",phoneticCode:s,language:n.language})})}}function K(r,n,a){const e=n.synonymMap.get(r);e&&e.forEach(s=>{a.has(s)||a.set(s,{word:s,normalized:r,matchType:"synonym",language:"synonym"})})}function G(r,n,a,e,s){if(r.length<s)return;const i=L(r,s),c=new Set;i.forEach(t=>{const o=n.ngramIndex.get(t);o&&o.forEach(l=>c.add(l))}),c.forEach(t=>{a.has(t)||a.set(t,{word:t,normalized:r,matchType:"ngram",language:e})})}function V(r,n,a,e,s){const i=s.maxEditDistance;for(const[c,t]of n.variantToBase.entries())if(Math.abs(c.length-r.length)<=i){const o=b(r,c,i);o<=i&&t.forEach(l=>{const g=a.get(l);(!g||(g.editDistance||1/0)>o)&&a.set(l,{word:l,normalized:c,matchType:"fuzzy",editDistance:o,language:e.language})})}}function _(r,n,a){const e=Q(r,n);return e<a?null:{display:r.word,baseWord:r.word,isSynonym:r.matchType==="synonym",score:e,language:r.language,_debug_matchType:r.matchType}}function Q(r,n){const a=n.length,e=r.word.length,s=Math.max(a,e);let i=.5;switch(r.matchType){case"exact":i=1;break;case"prefix":i=.9-(e-a)/(s*2);break;case"substring":i=.8;break;case"phonetic":i=.7;break;case"fuzzy":r.editDistance!==void 0&&(i=Math.max(.3,1-r.editDistance/s));break;case"synonym":i=.6;break;case"compound":i=.75;break;case"ngram":i=y(n.toLowerCase(),r.normalized,3)*.8;break}return e<=a+2&&r.matchType!=="exact"&&(i+=.1),Math.min(1,Math.max(0,i))}function L(r,n){if(r.length<n)return[r];const a=[];for(let e=0;e<=r.length-n;e++)a.push(r.slice(e,e+n));return a}function U(r,n={}){const a=j(r,{config:{languages:n.languages||["german"],performance:n.performance||"balanced",maxResults:n.maxResults||5}});return{search:(e,s)=>T(a,e,s),index:a}}const J="1.0.2";u.BaseLanguageProcessor=p,u.DEFAULT_CONFIG=f,u.EnglishProcessor=x,u.FrenchProcessor=E,u.GermanProcessor=v,u.LanguageRegistry=C,u.PERFORMANCE_CONFIGS=k,u.SpanishProcessor=S,u.VERSION=J,u.areStringsSimilar=q,u.buildFuzzyIndex=j,u.calculateDamerauLevenshteinDistance=A,u.calculateLevenshteinDistance=b,u.calculateNgramSimilarity=y,u.createFuzzySearch=U,u.distanceToSimilarity=P,u.getSuggestions=T,u.mergeConfig=w,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=fuzzyfindjs.min.js.map
