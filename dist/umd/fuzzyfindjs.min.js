(function(u,z){typeof exports=="object"&&typeof module<"u"?z(exports):typeof define=="function"&&define.amd?define(["exports"],z):(u=typeof globalThis<"u"?globalThis:u||self,z(u.FuzzyFindJS={}))})(this,(function(u){"use strict";const z={languages:["english"],features:["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters","transpositions"],performance:"balanced",maxResults:10,minQueryLength:2,fuzzyThreshold:.75,maxEditDistance:2,ngramSize:3},j={fast:{performance:"fast",features:["partial-words","missing-letters"],maxEditDistance:1,fuzzyThreshold:.9,maxResults:3},balanced:{performance:"balanced",features:["phonetic","partial-words","missing-letters","keyboard-neighbors"],maxEditDistance:2,fuzzyThreshold:.8,maxResults:5},comprehensive:{performance:"comprehensive",features:["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters","transpositions"],maxEditDistance:3,fuzzyThreshold:.7,maxResults:10}},W={german:["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"],english:["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","transpositions"],spanish:["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters"],french:["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters"]};function D(s={}){const t={...z};if(s.performance&&s.performance!=="balanced"){const e=j[s.performance];Object.assign(t,e)}const n={...t,...s};if(!s.features&&s.languages){const e=new Set;for(const r of s.languages)(W[r]||W.english).forEach(i=>e.add(i));n.features=Array.from(e)}return n}function J(s){if(s.maxResults<1)throw new Error("maxResults must be at least 1");if(s.minQueryLength<1)throw new Error("minQueryLength must be at least 1");if(s.fuzzyThreshold<0||s.fuzzyThreshold>1)throw new Error("fuzzyThreshold must be between 0 and 1");if(s.maxEditDistance<0)throw new Error("maxEditDistance must be non-negative");if(s.ngramSize<2)throw new Error("ngramSize must be at least 2");if(s.languages.length===0)throw new Error("At least one language must be specified")}class v{normalize(t){return t.toLowerCase().trim().replace(/\s+/g," ")}getPhoneticCode(t){const n=this.normalize(t);if(n.length===0)return"";let e=n[0].toUpperCase();const r={b:"1",f:"1",p:"1",v:"1",c:"2",g:"2",j:"2",k:"2",q:"2",s:"2",x:"2",z:"2",d:"3",t:"3",l:"4",m:"5",n:"5",r:"6"};for(let a=1;a<n.length&&e.length<4;a++){const i=n[a],o=r[i];o&&o!==e[e.length-1]&&(e+=o)}return e.padEnd(4,"0")}splitCompoundWords(t){return[t]}getWordVariants(t){const n=new Set,e=this.normalize(t);n.add(e),n.add(t);const r=this.getCommonEndings();for(const a of r)e.endsWith(a)&&e.length>a.length+2&&n.add(e.slice(0,-a.length));if(e.length>4)for(let a=3;a<e.length;a++)n.add(e.slice(0,a));return Array.from(n)}getCommonEndings(){return["s","es","ed","ing","er","est"]}getSynonyms(t){return[]}isValidSubstitution(t,n){const r=this.getKeyboardNeighbors()[t.toLowerCase()];return r?r.includes(n.toLowerCase()):!1}getKeyboardNeighbors(){return{q:["w","a","s"],w:["q","e","a","s","d"],e:["w","r","s","d","f"],r:["e","t","d","f","g"],t:["r","y","f","g","h"],y:["t","u","g","h","j"],u:["y","i","h","j","k"],i:["u","o","j","k","l"],o:["i","p","k","l"],p:["o","l"],a:["q","w","s","z","x"],s:["q","w","e","a","d","z","x","c"],d:["w","e","r","s","f","x","c","v"],f:["e","r","t","d","g","c","v","b"],g:["r","t","y","f","h","v","b","n"],h:["t","y","u","g","j","b","n","m"],j:["y","u","i","h","k","n","m"],k:["u","i","o","j","l","m"],l:["i","o","p","k"],z:["a","s","x"],x:["a","s","d","z","c"],c:["s","d","f","x","v"],v:["d","f","g","c","b"],b:["f","g","h","v","n"],n:["g","h","j","b","m"],m:["h","j","k","n"]}}generateNgrams(t,n=3){const e=this.normalize(t);if(e.length<n)return[e];const r=[];for(let a=0;a<=e.length-n;a++)r.push(e.slice(a,a+n));return r}calculateEditDistance(t,n){const e=[],r=t.length,a=n.length;for(let i=0;i<=r;i++)e[i]=[i];for(let i=0;i<=a;i++)e[0][i]=i;for(let i=1;i<=r;i++)for(let o=1;o<=a;o++){const c=t[i-1]===n[o-1]?0:1;e[i][o]=Math.min(e[i-1][o]+1,e[i][o-1]+1,e[i-1][o-1]+c)}return e[r][a]}}class P extends v{language="german";displayName="Deutsch";supportedFeatures=["phonetic","compound","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"];normalize(t){return t.toLowerCase().trim().replace(/\s+/g," ").replace(/ä/g,"ae").replace(/ö/g,"oe").replace(/ü/g,"ue").replace(/ß/g,"ss")}getPhoneticCode(t){const n=this.normalize(t);if(n.length===0)return"";let e="",r="";for(let a=0;a<n.length;a++){const i=n[a],o=a<n.length-1?n[a+1]:"";let c="";switch(i){case"a":case"e":case"i":case"j":case"o":case"u":case"y":c="0";break;case"h":continue;case"b":case"p":c="1";break;case"d":case"t":o==="c"||o==="s"||o==="z"?c="8":c="2";break;case"f":case"v":case"w":c="3";break;case"g":case"k":case"q":c="4";break;case"c":a===0?o==="a"||o==="h"||o==="k"||o==="l"||o==="o"||o==="q"||o==="r"||o==="u"||o==="x"?c="4":c="8":r==="s"||r==="z"?c="8":o==="h"||o==="k"||o==="q"?c="4":c="8";break;case"x":r==="c"||r==="k"||r==="q"?c="8":c="48";break;case"l":c="5";break;case"m":case"n":c="6";break;case"r":c="7";break;case"s":case"z":c="8";break;default:continue}c&&c!==r&&(e+=c),r=c}return e||"0"}splitCompoundWords(t){const n=this.normalize(t);if(n.length<6)return[t];const e=[],r=this.getCommonPrefixes(),a=this.getCommonSuffixes(),i=this.getCommonWords();for(const o of r)if(n.startsWith(o)&&n.length>o.length+3){const c=n.slice(o.length);e.push(o),e.push(...this.splitCompoundWords(c));break}if(e.length===0){for(const o of a)if(n.endsWith(o)&&n.length>o.length+3){const c=n.slice(0,-o.length);e.push(...this.splitCompoundWords(c)),e.push(o);break}}if(e.length===0)for(let o=3;o<=n.length-3;o++){const c=n.slice(0,o),l=n.slice(o);if(i.has(c)&&l.length>=3){e.push(c),e.push(...this.splitCompoundWords(l));break}}return e.length>0?e:[t]}getWordVariants(t){const n=new Set,e=this.normalize(t);n.add(e),n.add(t),this.splitCompoundWords(t).forEach(i=>n.add(this.normalize(i)));const a=this.getCommonEndings();for(const i of a)e.endsWith(i)&&e.length>i.length+2&&n.add(e.slice(0,-i.length));if(e.length>4)for(let i=3;i<e.length;i++)n.add(e.slice(0,i));return Array.from(n)}getCommonEndings(){return["en","e","er","n","r","s","es","t","ung","heit","keit","schaft","chen","lein","lich","ig","isch","bar","los","voll"]}getSynonyms(t){const n={arzt:["doktor","mediziner","doc"],krankenhaus:["spital","klinik","hospital"],schule:["bildungseinrichtung","lehranstalt"],auto:["wagen","fahrzeug","pkw"],haus:["gebaeude","heim","wohnhaus"],strasse:["weg","gasse","allee"],stadt:["ort","gemeinde","ortschaft"],arbeit:["job","beruf","taetigkeit"],geld:["waehrung","kapital","finanzen"],zeit:["dauer","periode","zeitraum"]},e=this.normalize(t);return n[e]||[]}getKeyboardNeighbors(){return{q:["w","a","s"],w:["q","e","a","s","d"],e:["w","r","s","d","f"],r:["e","t","d","f","g"],t:["r","z","f","g","h"],z:["t","u","g","h","j"],u:["z","i","h","j","k"],i:["u","o","j","k","l"],o:["i","p","k","l","oe"],p:["o","ue","l","oe"],ue:["p","ae"],a:["q","w","s","y","x"],s:["q","w","e","a","d","y","x","c"],d:["w","e","r","s","f","x","c","v"],f:["e","r","t","d","g","c","v","b"],g:["r","t","z","f","h","v","b","n"],h:["t","z","u","g","j","b","n","m"],j:["z","u","i","h","k","n","m"],k:["u","i","o","j","l","m"],l:["i","o","p","k","oe"],oe:["o","p","ue","l","ae"],ae:["ue","oe"],y:["a","s","x"],x:["a","s","d","y","c"],c:["s","d","f","x","v"],v:["d","f","g","c","b"],b:["f","g","h","v","n"],n:["g","h","j","b","m"],m:["h","j","k","n"]}}getCommonPrefixes(){return["un","vor","nach","bei","mit","ab","an","auf","aus","ein","gegen","hinter","neben","ueber","unter","zwischen","selbst"]}getCommonSuffixes(){return["haus","platz","strasse","weg","hof","berg","tal","feld","stadt","dorf","heim","werk","bau","anlage","zentrum"]}getCommonWords(){return new Set(["kranken","kinder","frauen","maenner","alt","neu","gross","klein","hoch","tief","lang","kurz","breit","schmal","dick","duenn","stark","schwach","schnell","langsam","heiss","kalt","warm","auto","bahn","bus","zug","flug","schiff","rad","motor","wasser","feuer","erde","luft","licht","schatten","sonne","mond","tag","nacht","morgen","abend","mittag","zeit","jahr","monat"])}}class E extends v{language="english";displayName="English";supportedFeatures=["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters","transpositions"];normalize(t){return t.toLowerCase().trim().replace(/\s+/g," ").replace(/won't/g,"will not").replace(/can't/g,"cannot").replace(/n't/g," not").replace(/'re/g," are").replace(/'ve/g," have").replace(/'ll/g," will").replace(/'d/g," would").replace(/'m/g," am").replace(/'/g,"")}getPhoneticCode(t){const n=this.normalize(t).replace(/[^a-z]/g,"");if(n.length===0)return"";let e="",r=0;const a=n.length;for((n.startsWith("gn")||n.startsWith("kn")||n.startsWith("pn")||n.startsWith("wr"))&&(r=1);r<a&&e.length<4;){const i=n[r],o=r+1<a?n[r+1]:"",c=r>0?n[r-1]:"";switch(i){case"a":case"e":case"i":case"o":case"u":r===0&&(e+=i.toUpperCase());break;case"b":r===a-1&&c==="m"||(e+="B");break;case"c":o==="h"?(e+="X",r++):o==="i"||o==="e"||o==="y"?e+="S":e+="K";break;case"d":o==="g"?(e+="J",r++):e+="T";break;case"f":e+="F";break;case"g":o==="h"&&r!==0||(o==="n"?(e+="N",r++):o==="i"||o==="e"||o==="y"?e+="J":e+="K");break;case"h":(r===0||"aeiou".includes(c)||"aeiou".includes(o))&&(e+="H");break;case"j":e+="J";break;case"k":c!=="c"&&(e+="K");break;case"l":e+="L";break;case"m":e+="M";break;case"n":e+="N";break;case"p":o==="h"?(e+="F",r++):e+="P";break;case"q":e+="K";break;case"r":e+="R";break;case"s":o==="h"?(e+="X",r++):e+="S";break;case"t":o==="h"?(e+="0",r++):o==="i"&&r+2<a&&(n[r+2]==="a"||n[r+2]==="o")?e+="X":e+="T";break;case"v":e+="F";break;case"w":"aeiou".includes(o)&&(e+="W");break;case"x":e+="KS";break;case"y":"aeiou".includes(o)&&(e+="Y");break;case"z":e+="S";break}r++}return e||"A"}getWordVariants(t){const n=new Set,e=this.normalize(t);n.add(e),n.add(t);const r=this.getCommonEndings();for(const a of r)e.endsWith(a)&&e.length>a.length+2&&n.add(e.slice(0,-a.length));if(e.endsWith("s")&&e.length>3&&n.add(e.slice(0,-1)),e.endsWith("s")||n.add(e+"s"),e.endsWith("ing")&&e.length>5){const a=e.slice(0,-3);n.add(a),n.add(a+"e")}if(e.endsWith("ed")&&e.length>4){const a=e.slice(0,-2);n.add(a),n.add(a+"e")}if(e.length>4)for(let a=3;a<e.length;a++)n.add(e.slice(0,a));return Array.from(n)}getCommonEndings(){return["s","es","ed","ing","er","est","ly","tion","sion","ness","ment","able","ible","ful","less","ous","ious","al","ial","ic","ive","ary","ery","ory"]}getSynonyms(t){const n={doctor:["physician","medic","doc","md"],hospital:["clinic","medical center","infirmary"],school:["academy","institution","college","university"],car:["vehicle","automobile","auto"],house:["home","residence","dwelling","building"],street:["road","avenue","lane","boulevard"],city:["town","municipality","urban area"],work:["job","employment","occupation","career"],money:["cash","currency","funds","capital"],time:["duration","period","moment","hour"],big:["large","huge","enormous","massive","giant"],small:["little","tiny","miniature","petite"],fast:["quick","rapid","speedy","swift"],slow:["sluggish","gradual","leisurely"],good:["excellent","great","wonderful","fine"],bad:["poor","terrible","awful","horrible"],happy:["joyful","cheerful","glad","pleased"],sad:["unhappy","depressed","melancholy","sorrowful"]},e=this.normalize(t);return n[e]||[]}}class M extends v{language="spanish";displayName="Español";supportedFeatures=["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"];normalize(t){return t.toLowerCase().trim().replace(/\s+/g," ").replace(/á/g,"a").replace(/é/g,"e").replace(/í/g,"i").replace(/ó/g,"o").replace(/ú/g,"u").replace(/ñ/g,"n").replace(/ü/g,"u")}getPhoneticCode(t){const n=this.normalize(t);if(n.length===0)return"";let e="",r="";for(let a=0;a<n.length;a++){const i=n[a],o=a<n.length-1?n[a+1]:"";let c="";switch(i){case"a":case"e":case"i":case"o":case"u":c="0";break;case"b":case"v":c="1";break;case"c":o==="h"?c="2":o==="e"||o==="i"?c="8":c="4";break;case"d":c="3";break;case"f":c="5";break;case"g":o==="u"&&a+2<n.length&&(n[a+2]==="e"||n[a+2]==="i")?c="4":o==="e"||o==="i"?c="6":c="4";break;case"h":continue;case"j":c="6";break;case"k":c="4";break;case"l":o==="l"?c="7":c="5";break;case"m":c="6";break;case"n":o==="n"?c="7":c="6";break;case"ñ":c="7";break;case"p":c="1";break;case"q":c="4";break;case"r":o==="r"||a===0?c="8":c="7";break;case"s":c="8";break;case"t":c="3";break;case"w":c="1";break;case"x":c="48";break;case"y":c="7";break;case"z":c="8";break;default:continue}c&&c!==r&&(e+=c),r=c}return e||"0"}getCommonEndings(){return["o","a","os","as","e","es","ar","er","ir","ado","ada","idos","idas","ando","endo","iendo","cion","sion","dad","tad","mente","oso","osa","ito","ita","illo","illa"]}getSynonyms(t){const n={medico:["doctor","facultativo"],hospital:["clinica","sanatorio"],escuela:["colegio","instituto"],coche:["auto","automovil","vehiculo"],casa:["hogar","vivienda","domicilio"],calle:["via","avenida","carretera"],ciudad:["urbe","poblacion","municipio"],trabajo:["empleo","ocupacion","labor"],dinero:["plata","efectivo","capital"],tiempo:["momento","periodo","duracion"],grande:["enorme","gigante","inmenso"],pequeno:["chico","diminuto","minusculo"],rapido:["veloz","ligero","acelerado"],lento:["despacio","pausado"],bueno:["excelente","magnifico","estupendo"],malo:["pesimo","terrible","horrible"]},e=this.normalize(t);return n[e]||[]}}class C extends v{language="french";displayName="Français";supportedFeatures=["phonetic","synonyms","keyboard-neighbors","partial-words","missing-letters","extra-letters"];normalize(t){return t.toLowerCase().trim().replace(/\s+/g," ").replace(/[àáâãä]/g,"a").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/[òóôõö]/g,"o").replace(/[ùúûü]/g,"u").replace(/ç/g,"c").replace(/ñ/g,"n").replace(/ÿ/g,"y")}getPhoneticCode(t){const n=this.normalize(t);if(n.length===0)return"";let e="",r="";for(let a=0;a<n.length;a++){const i=n[a],o=a<n.length-1?n[a+1]:"",c=a<n.length-2?n[a+2]:"";let l="";switch(i){case"a":case"e":case"i":case"o":case"u":case"y":l="0";break;case"b":l="1";break;case"c":o==="h"?l="2":o==="e"||o==="i"?l="8":l="4";break;case"d":l="3";break;case"f":l="5";break;case"g":o==="n"?l="6":o==="u"&&(c==="e"||c==="i")?l="4":o==="e"||o==="i"?l="6":l="4";break;case"h":a===0&&(l="0");break;case"j":l="6";break;case"k":l="4";break;case"l":l="5";break;case"m":l="6";break;case"n":l="6";break;case"p":o==="h"?l="5":l="1";break;case"q":l="4";break;case"r":l="7";break;case"s":l="8";break;case"t":l="3";break;case"v":l="5";break;case"w":l="5";break;case"x":l="48";break;case"z":l="8";break;default:continue}l&&l!==r&&(e+=l),r=l}return e||"0"}getCommonEndings(){return["e","es","s","x","ent","ant","ment","tion","sion","eur","euse","teur","trice","able","ible","ique","aire","oire","ette","elle","esse","asse","isse","age","isme","iste","ite","ude","ade"]}getSynonyms(t){const n={medecin:["docteur","praticien"],hopital:["clinique","centre medical"],ecole:["etablissement","institution"],voiture:["automobile","vehicule","auto"],maison:["domicile","residence","habitation"],rue:["avenue","boulevard","voie"],ville:["cite","commune","agglomeration"],travail:["emploi","occupation","metier"],argent:["monnaie","especes","capital"],temps:["duree","periode","moment"],grand:["enorme","immense","gigantesque"],petit:["minuscule","minime","reduit"],rapide:["vite","accelere","prompt"],lent:["lentement","doucement"],bon:["excellent","parfait","formidable"],mauvais:["terrible","affreux","horrible"],heureux:["joyeux","content","ravi"],triste:["malheureux","chagrine","melancolique"]},e=this.normalize(t);return n[e]||[]}getKeyboardNeighbors(){return{a:["z","e","r","q","s"],z:["a","e","r","q","s","d"],e:["z","r","t","s","d","f"],r:["e","t","y","d","f","g"],t:["r","y","u","f","g","h"],y:["t","u","i","g","h","j"],u:["y","i","o","h","j","k"],i:["u","o","p","j","k","l"],o:["i","p","k","l","m"],p:["o","l","m"],q:["a","z","s","w","x"],s:["a","z","e","q","d","w","x","c"],d:["z","e","r","s","f","x","c","v"],f:["e","r","t","d","g","c","v","b"],g:["r","t","y","f","h","v","b","n"],h:["t","y","u","g","j","b","n"],j:["y","u","i","h","k","n"],k:["u","i","o","j","l"],l:["i","o","p","k","m"],m:["o","p","l"],w:["q","s","x"],x:["q","s","d","w","c"],c:["s","d","f","x","v"],v:["d","f","g","c","b"],b:["f","g","h","v","n"],n:["g","h","j","b"]}}}class I{static processors=new Map([["german",new P],["english",new E],["spanish",new M],["french",new C]]);static getProcessor(t){return this.processors.get(t.toLowerCase())}static getProcessors(t){return t.map(n=>this.getProcessor(n)).filter(n=>n!==void 0)}static getAvailableLanguages(){return Array.from(this.processors.keys())}static registerProcessor(t){this.processors.set(t.language.toLowerCase(),t)}static isSupported(t){return this.processors.has(t.toLowerCase())}static getProcessorInfo(){return Array.from(this.processors.values()).map(t=>({language:t.language,displayName:t.displayName,supportedFeatures:t.supportedFeatures}))}}const q=Object.freeze(Object.defineProperty({__proto__:null,BaseLanguageProcessor:v,EnglishProcessor:E,FrenchProcessor:C,GermanProcessor:P,LanguageRegistry:I,SpanishProcessor:M},Symbol.toStringTag,{value:"Module"}));function k(s,t,n=1/0){const e=s.length,r=t.length;if(Math.abs(e-r)>n)return n+1;if(e===0)return r;if(r===0)return e;if(s===t)return 0;let a=new Array(r+1),i=new Array(r+1);for(let o=0;o<=r;o++)a[o]=o;for(let o=1;o<=e;o++){i[0]=o;let c=o;for(let l=1;l<=r;l++){const g=s[o-1]===t[l-1]?0:1;i[l]=Math.min(i[l-1]+1,a[l]+1,a[l-1]+g),c=Math.min(c,i[l])}if(c>n)return n+1;[a,i]=[i,a]}return a[r]}function Y(s,t,n=1/0){const e=s.length,r=t.length;if(Math.abs(e-r)>n)return n+1;if(e===0)return r;if(r===0)return e;if(s===t)return 0;const a=Math.max(e,r),i=[],o=a+1;for(let g=0;g<=e+1;g++)i[g]=new Array(r+2).fill(o);i[0][0]=o;for(let g=0;g<=e;g++)i[g+1][0]=o,i[g+1][1]=g;for(let g=0;g<=r;g++)i[0][g+1]=o,i[1][g+1]=g;const c=new Map;for(let g=1;g<=e;g++){let h=0;for(let f=1;f<=r;f++){const p=s[g-1],T=t[f-1],N=c.get(T)||0;let y=1;p===T&&(y=0,h=f),i[g+1][f+1]=Math.min(i[g][f]+y,i[g+1][f]+1,i[g][f+1]+1,i[N][h]+(g-N-1)+1+(f-h-1))}c.set(s[g-1],g)}const l=i[e+1][r+1];return l>n?n+1:l}function L(s,t,n=3){if(s===t)return 1;if(s.length===0||t.length===0)return 0;const e=R(s,n),r=R(t,n);if(e.length===0&&r.length===0)return 1;if(e.length===0||r.length===0)return 0;const a=new Set(e),i=new Set(r),o=new Set([...a].filter(l=>i.has(l))),c=new Set([...a,...i]);return o.size/c.size}function R(s,t){if(s.length<t)return[s];const n=[];for(let e=0;e<=s.length-t;e++)n.push(s.slice(e,e+t));return n}function O(s,t){return t===0?s===0?1:0:Math.max(0,1-s/t)}function X(s,t,n=.8,e=2){if(s===t)return!0;const r=Math.max(s.length,t.length);if(Math.abs(s.length-t.length)>e||L(s,t)<n-.2)return!1;const i=k(s,t,e);return O(i,r)>=n}function Z(s,t,n,e){const r=[],a={termToPostings:new Map,phoneticToPostings:new Map,ngramToPostings:new Map,synonymToPostings:new Map,fieldIndices:new Map,totalDocs:0,avgDocLength:0};let i=0,o=0;for(const c of s){if(!c||c.trim().length<n.minQueryLength)continue;const l=c.trim();for(const g of t){const h=g.normalize(l),f=e.has("phonetic")&&g.supportedFeatures.includes("phonetic")?g.getPhoneticCode(l):void 0,p=e.has("compound")&&g.supportedFeatures.includes("compound")?g.splitCompoundWords(l):void 0,T={id:o,word:l,normalized:h,phoneticCode:f,language:g.language,compoundParts:p&&p.length>1?p:void 0};if(r.push(T),i+=h.length,d(a.termToPostings,h,o),d(a.termToPostings,l.toLowerCase(),o),e.has("partial-words")&&g.getWordVariants(l).forEach(b=>{d(a.termToPostings,b,o)}),f&&d(a.phoneticToPostings,f,o),B(h,n.ngramSize).forEach(y=>{d(a.ngramToPostings,y,o)}),p&&p.length>1&&p.forEach(y=>{const b=g.normalize(y);d(a.termToPostings,b,o)}),e.has("synonyms")&&(g.getSynonyms(h).forEach(b=>{d(a.synonymToPostings,b,o)}),n.customSynonyms)){const b=n.customSynonyms[h];b&&b.forEach(Ie=>{d(a.synonymToPostings,Ie,o)})}o++}}return a.totalDocs=o,a.avgDocLength=i/Math.max(1,o),{invertedIndex:a,documents:r}}function ee(s,t,n,e,r){const a=new Map,i=new Set(r.features);for(const o of e){const c=o.normalize(n.trim());te(c,s,t,a,o.language),ne(c,s,t,a,o.language),i.has("phonetic")&&o.supportedFeatures.includes("phonetic")&&se(c,o,s,t,a),i.has("synonyms")&&ae(c,s,t,a),re(c,s,t,a,o.language,r.ngramSize),(i.has("missing-letters")||i.has("extra-letters")||i.has("transpositions"))&&oe(c,s,t,a,o,r.maxEditDistance)}return Array.from(a.values())}function d(s,t,n){let e=s.get(t);e||(e={term:t,docIds:[]},s.set(t,e)),e.docIds.includes(n)||e.docIds.push(n)}function B(s,t){if(s.length<t)return[s];const n=[];for(let e=0;e<=s.length-t;e++)n.push(s.slice(e,e+t));return n}function te(s,t,n,e,r){const a=t.termToPostings.get(s);a&&a.docIds.forEach(i=>{const o=n[i];o&&(e.has(i)||e.set(i,{word:o.word,normalized:s,matchType:"exact",editDistance:0,language:r}))})}function ne(s,t,n,e,r){for(const[a,i]of t.termToPostings.entries())a.startsWith(s)&&a!==s&&i.docIds.forEach(o=>{const c=n[o];c&&(e.has(o)||e.set(o,{word:c.word,normalized:a,matchType:"prefix",language:r}))})}function se(s,t,n,e,r){const a=t.getPhoneticCode(s);if(!a)return;const i=n.phoneticToPostings.get(a);i&&i.docIds.forEach(o=>{const c=e[o];c&&(r.has(o)||r.set(o,{word:c.word,normalized:s,matchType:"phonetic",phoneticCode:a,language:t.language}))})}function ae(s,t,n,e){const r=t.synonymToPostings.get(s);r&&r.docIds.forEach(a=>{const i=n[a];i&&(e.has(a)||e.set(a,{word:i.word,normalized:s,matchType:"synonym",language:"synonym"}))})}function re(s,t,n,e,r,a){if(s.length<a)return;const i=B(s,a),o=new Set;i.forEach(c=>{const l=t.ngramToPostings.get(c);l&&l.docIds.forEach(g=>o.add(g))}),o.forEach(c=>{const l=n[c];l&&(e.has(c)||e.set(c,{word:l.word,normalized:s,matchType:"ngram",language:r}))})}function oe(s,t,n,e,r,a){for(const[i,o]of t.termToPostings.entries()){if(Math.abs(i.length-s.length)>a)continue;const c=k(s,i,a);c<=a&&o.docIds.forEach(l=>{const g=n[l];if(!g)return;const h=e.get(l);(!h||(h.editDistance||1/0)>c)&&e.set(l,{word:g.word,normalized:i,matchType:"fuzzy",editDistance:c,language:r.language})})}}function _(s,t,n){const e=[],r=n.toLowerCase(),a=t.toLowerCase();switch(s.matchType){case"exact":e.push({start:0,end:n.length,type:"exact"});break;case"prefix":const i=Math.min(a.length,n.length);e.push({start:0,end:i,type:"prefix"});break;case"substring":const o=r.indexOf(a);o!==-1&&e.push({start:o,end:o+a.length,type:"substring"});break;case"fuzzy":e.push(...ie(a,r,"fuzzy"));break;case"ngram":e.push(...ce(a,r));break;case"phonetic":case"synonym":case"compound":e.push({start:0,end:n.length,type:s.matchType});break}return le(e)}function ie(s,t,n){const e=[];let r=0,a=0;for(;r<s.length&&a<t.length;)if(s[r]===t[a]){const i=a;let o=a+1;for(r++,a++;r<s.length&&a<t.length&&s[r]===t[a];)o++,r++,a++;e.push({start:i,end:o,type:n})}else a++;return e}function ce(s,t){const n=[];for(let r=0;r<=s.length-3;r++){const a=s.slice(r,r+3);let i=0;for(;;){const o=t.indexOf(a,i);if(o===-1)break;n.push({start:o,end:o+3,type:"ngram"}),i=o+1}}return n}function le(s){if(s.length===0)return[];const t=[...s].sort((e,r)=>e.start-r.start),n=[t[0]];for(let e=1;e<t.length;e++){const r=t[e],a=n[n.length-1];r.start<=a.end?(a.end=Math.max(a.end,r.end),U(r.type)>U(a.type)&&(a.type=r.type)):n.push(r)}return n}function U(s){return{exact:10,prefix:9,substring:8,fuzzy:7,ngram:6,phonetic:5,compound:4,synonym:3}[s]||0}function ge(s,t,n="highlight"){if(!t||t.length===0)return w(s);let e="",r=0;for(const a of t){a.start>r&&(e+=w(s.slice(r,a.start)));const i=s.slice(a.start,a.end);e+=`<mark class="${n} ${n}--${a.type}">${w(i)}</mark>`,r=a.end}return r<s.length&&(e+=w(s.slice(r))),e}function w(s){const t=typeof document<"u"?document.createElement("div"):null;return t?(t.textContent=s,t.innerHTML):s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}class H{cache;capacity;constructor(t=100){this.cache=new Map,this.capacity=t}get(t){if(!this.cache.has(t))return;const n=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,n),n}set(t,n){if(this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,n),this.cache.size>this.capacity){const e=this.cache.keys().next().value;e!==void 0&&this.cache.delete(e)}}has(t){return this.cache.has(t)}clear(){this.cache.clear()}get size(){return this.cache.size}getStats(){return{size:this.cache.size,capacity:this.capacity,utilization:this.cache.size/this.capacity}}}class x{cache;hits=0;misses=0;constructor(t=100){this.cache=new H(t)}getCacheKey(t,n,e){const r=e?JSON.stringify(e):"";return`${t}|${n||"default"}|${r}`}get(t,n,e){const r=this.getCacheKey(t,n,e),a=this.cache.get(r);return a?this.hits++:this.misses++,a}set(t,n,e,r){const a=this.getCacheKey(t,e,r);this.cache.set(a,n)}clear(){this.cache.clear(),this.hits=0,this.misses=0}getStats(){const t=this.cache.getStats(),n=this.hits+this.misses,e=n>0?this.hits/n:0;return{...t,hits:this.hits,misses:this.misses,hitRate:e}}}const K={à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",ā:"a",ă:"a",ą:"a",À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",Ā:"A",Ă:"A",Ą:"A",è:"e",é:"e",ê:"e",ë:"e",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",È:"E",É:"E",Ê:"E",Ë:"E",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ì:"i",í:"i",î:"i",ï:"i",ĩ:"i",ī:"i",ĭ:"i",į:"i",Ì:"I",Í:"I",Î:"I",Ï:"I",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",ō:"o",ŏ:"o",ő:"o",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",Ō:"O",Ŏ:"O",Ő:"O",ù:"u",ú:"u",û:"u",ü:"u",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ù:"U",Ú:"U",Û:"U",Ü:"U",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ý:"y",ÿ:"y",ŷ:"y",Ý:"Y",Ÿ:"Y",Ŷ:"Y",ñ:"n",ń:"n",ņ:"n",ň:"n",Ñ:"N",Ń:"N",Ņ:"N",Ň:"N",ç:"c",ć:"c",ĉ:"c",ċ:"c",č:"c",Ç:"C",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ß:"ss",ð:"d",đ:"d",Ð:"D",Đ:"D",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĥ:"h",ħ:"h",Ĥ:"H",Ħ:"H",ĵ:"j",Ĵ:"J",ķ:"k",Ķ:"K",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ŕ:"r",ŗ:"r",ř:"r",Ŕ:"R",Ŗ:"R",Ř:"R",ś:"s",ŝ:"s",ş:"s",š:"s",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ţ:"t",ť:"t",ŧ:"t",Ţ:"T",Ť:"T",Ŧ:"T",ŵ:"w",Ŵ:"W",ź:"z",ż:"z",ž:"z",Ź:"Z",Ż:"Z",Ž:"Z",æ:"ae",œ:"oe",Æ:"AE",Œ:"OE",þ:"th",Þ:"TH"};function S(s){if(!s)return s;let t="";for(let n=0;n<s.length;n++){const e=s[n];t+=K[e]||e}return t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,""),t}function he(s){if(!s)return!1;for(let n=0;n<s.length;n++)if(K[s[n]])return!0;const t=s.normalize("NFD");return/[\u0300-\u036f]/.test(t)}function ue(s){return S(s.toLowerCase())}function fe(s){const t=S(s);return t!==s?[s,t]:[s]}function G(s=[],t={}){const n=D(t.config);J(n);const e=new Set(n.features),r=t.languageProcessors||I.getProcessors(n.languages);if(r.length===0)throw new Error(`No language processors found for: ${n.languages.join(", ")}`);const a={base:[],variantToBase:new Map,phoneticToBase:new Map,ngramIndex:new Map,synonymMap:new Map,languageProcessors:new Map,config:n};r.forEach(g=>{a.languageProcessors.set(g.language,g)});const i=new Set;let o=0;for(const g of s){if(!g||g.trim().length<n.minQueryLength)continue;const h=g.trim();if(!i.has(h.toLowerCase())){i.add(h.toLowerCase()),a.base.push(h);for(const f of r)me(h,f,a,n,e);o++,t.onProgress&&t.onProgress(o,s.length)}}if(t.useInvertedIndex||n.useInvertedIndex||s.length>=1e4){const{invertedIndex:g,documents:h}=Z(s,r,n,e);a.invertedIndex=g,a.documents=h}if(n.enableCache!==!1){const g=n.cacheSize||100;a._cache=new x(g)}return a}function me(s,t,n,e,r){const a=t.normalize(s);m(n.variantToBase,a,s),m(n.variantToBase,s.toLowerCase(),s),m(n.variantToBase,s,s);const i=S(s);if(i!==s){m(n.variantToBase,i,s),m(n.variantToBase,i.toLowerCase(),s);const c=t.normalize(i);c!==i.toLowerCase()&&m(n.variantToBase,c,s)}if(r.has("partial-words")&&t.getWordVariants(s).forEach(l=>{m(n.variantToBase,l,s)}),r.has("phonetic")&&t.supportedFeatures.includes("phonetic")){const c=t.getPhoneticCode(s);c&&m(n.phoneticToBase,c,s)}if($(a,e.ngramSize).forEach(c=>{m(n.ngramIndex,c,s)}),r.has("compound")&&t.supportedFeatures.includes("compound")&&t.splitCompoundWords(s).forEach(l=>{l!==s&&m(n.variantToBase,t.normalize(l),s)}),r.has("synonyms")&&(t.getSynonyms(a).forEach(l=>{m(n.synonymMap,l,s)}),e.customSynonyms)){const l=e.customSynonyms[a];l&&l.forEach(g=>{m(n.synonymMap,g,s)})}}function m(s,t,n){s.has(t)||s.set(t,new Set),s.get(t).add(n)}function de(s,t,n,e={}){const r={},a=[...new Set(t)];for(const i of a)r[i]=A(s,i,n,e);return r}function A(s,t,n,e={}){const r=s.config,a=n||e.maxResults||r.maxResults,i=e.fuzzyThreshold||r.fuzzyThreshold;if(!t||t.trim().length<r.minQueryLength)return[];if(s._cache){const h=s._cache.get(t,a,e);if(h)return h}const c=(e.languages||r.languages).map(h=>s.languageProcessors.get(h)).filter(h=>h!==void 0);if(c.length===0)return[];if(s.invertedIndex&&s.documents){const h=Se(s,t,a,i,c,e);return s._cache&&s._cache.set(t,h,a,e),h}const l=new Map;for(const h of c){const f=h.normalize(t.trim());pe(f,s,l,h.language),ye(f,s,l,h.language),be(f,h,s,l),ze(f,s,l),ve(f,s,l,h.language,r.ngramSize),(r.features.includes("missing-letters")||r.features.includes("extra-letters")||r.features.includes("transpositions"))&&ke(f,s,l,h,r)}const g=Array.from(l.values()).map(h=>V(h,t,i,e)).filter(h=>h!==null).sort((h,f)=>f.score-h.score).slice(0,a);return s._cache&&s._cache.set(t,g,a,e),g}function pe(s,t,n,e){const r=t.variantToBase.get(s);r&&r.forEach(i=>{const o=n.get(i);(!o||o.matchType!=="exact")&&n.set(i,{word:i,normalized:s,matchType:"exact",editDistance:0,language:e})});const a=s.toLowerCase();for(const i of t.base)i.toLowerCase()===a&&(n.has(i)||n.set(i,{word:i,normalized:s,matchType:"exact",editDistance:0,language:e}))}function ye(s,t,n,e){for(const[r,a]of t.variantToBase.entries())r.startsWith(s)&&r!==s&&a.forEach(i=>{n.has(i)||n.set(i,{word:i,normalized:r,matchType:"prefix",language:e})})}function be(s,t,n,e){if(!t.supportedFeatures.includes("phonetic"))return;const r=t.getPhoneticCode(s);if(r){const a=n.phoneticToBase.get(r);a&&a.forEach(i=>{e.has(i)||e.set(i,{word:i,normalized:s,matchType:"phonetic",phoneticCode:r,language:t.language})})}}function ze(s,t,n){const e=t.synonymMap.get(s);e&&e.forEach(r=>{n.has(r)||n.set(r,{word:r,normalized:s,matchType:"synonym",language:"synonym"})})}function ve(s,t,n,e,r){if(s.length<r)return;const a=$(s,r),i=new Set;a.forEach(o=>{const c=t.ngramIndex.get(o);c&&c.forEach(l=>i.add(l))}),i.forEach(o=>{n.has(o)||n.set(o,{word:o,normalized:s,matchType:"ngram",language:e})})}function ke(s,t,n,e,r){const a=r.maxEditDistance;for(const[i,o]of t.variantToBase.entries())if(Math.abs(i.length-s.length)<=a){const c=k(s,i,a);c<=a&&o.forEach(l=>{const g=n.get(l);(!g||g.matchType!=="exact"&&g.matchType!=="prefix"&&(g.editDistance||1/0)>c)&&n.set(l,{word:l,normalized:i,matchType:"fuzzy",editDistance:c,language:e.language})})}}function V(s,t,n,e){const r=we(s,t);if(r<n)return null;const a={display:s.word,baseWord:s.word,isSynonym:s.matchType==="synonym",score:r,language:s.language,_debug_matchType:s.matchType};return e?.includeHighlights&&(a.highlights=_(s,t,s.word)),a}function we(s,t){const n=t.length,e=s.word.length,r=Math.max(n,e);let a=.5;switch(s.matchType){case"exact":a=1;break;case"prefix":a=.9-(e-n)/(r*2);break;case"substring":a=.8;break;case"phonetic":a=.7;break;case"fuzzy":s.editDistance!==void 0&&(a=Math.max(.3,1-s.editDistance/r));break;case"synonym":a=.6;break;case"compound":a=.75;break;case"ngram":a=L(t.toLowerCase(),s.normalized,3)*.8;break}return e<=n+2&&s.matchType!=="exact"&&(a+=.1),Math.min(1,Math.max(0,a))}function $(s,t){if(s.length<t)return[s];const n=[];for(let e=0;e<=s.length-t;e++)n.push(s.slice(e,e+t));return n}function Se(s,t,n,e,r,a){if(!s.invertedIndex||!s.documents)throw new Error("Inverted index not available");return ee(s.invertedIndex,s.documents,t,r,s.config).map(c=>V(c,t,e,a)).filter(c=>c!==null).sort((c,l)=>l.score-c.score).slice(0,n)}function F(s){const t={version:"1.0",base:s.base,variantToBase:Array.from(s.variantToBase.entries()).map(([n,e])=>[n,Array.from(e)]),phoneticToBase:Array.from(s.phoneticToBase.entries()).map(([n,e])=>[n,Array.from(e)]),ngramIndex:Array.from(s.ngramIndex.entries()).map(([n,e])=>[n,Array.from(e)]),synonymMap:Array.from(s.synonymMap.entries()).map(([n,e])=>[n,Array.from(e)]),config:s.config,languageProcessorNames:Array.from(s.languageProcessors.keys())};return s.invertedIndex&&(t.invertedIndex={termToPostings:Array.from(s.invertedIndex.termToPostings.entries()),phoneticToPostings:Array.from(s.invertedIndex.phoneticToPostings.entries()),ngramToPostings:Array.from(s.invertedIndex.ngramToPostings.entries()),synonymToPostings:Array.from(s.invertedIndex.synonymToPostings.entries()),totalDocs:s.invertedIndex.totalDocs,avgDocLength:s.invertedIndex.avgDocLength}),s.documents&&(t.documents=s.documents),JSON.stringify(t)}async function Q(s){const t=JSON.parse(s),n=new Map(t.variantToBase.map(([l,g])=>[l,new Set(g)])),e=new Map(t.phoneticToBase.map(([l,g])=>[l,new Set(g)])),r=new Map(t.ngramIndex.map(([l,g])=>[l,new Set(g)])),a=new Map(t.synonymMap.map(([l,g])=>[l,new Set(g)])),{LanguageRegistry:i}=await Promise.resolve().then(()=>q),o=new Map;for(const l of t.languageProcessorNames){const g=i.getProcessor(l);g&&o.set(l,g)}const c={base:t.base,variantToBase:n,phoneticToBase:e,ngramIndex:r,synonymMap:a,languageProcessors:o,config:t.config};if(t.invertedIndex&&(c.invertedIndex={termToPostings:new Map(t.invertedIndex.termToPostings),phoneticToPostings:new Map(t.invertedIndex.phoneticToPostings),ngramToPostings:new Map(t.invertedIndex.ngramToPostings),synonymToPostings:new Map(t.invertedIndex.synonymToPostings),totalDocs:t.invertedIndex.totalDocs,avgDocLength:t.invertedIndex.avgDocLength}),t.documents&&(c.documents=t.documents),t.config.enableCache!==!1){const l=t.config.cacheSize||100;c._cache=new x(l)}return c}function Te(s,t="fuzzy-search-index"){if(typeof localStorage>"u")throw new Error("localStorage is not available");const n=F(s);localStorage.setItem(t,n)}async function Pe(s="fuzzy-search-index"){if(typeof localStorage>"u")throw new Error("localStorage is not available");const t=localStorage.getItem(s);return t?await Q(t):null}function Ee(s){const t=F(s);return new Blob([t]).size}function Me(s,t={}){const n=G(s,{config:{languages:t.languages||["german"],performance:t.performance||"balanced",maxResults:t.maxResults||5}});return{search:(e,r)=>A(n,e,r),index:n}}const Ce="1.0.2";u.BaseLanguageProcessor=v,u.DEFAULT_CONFIG=z,u.EnglishProcessor=E,u.FrenchProcessor=C,u.GermanProcessor=P,u.LRUCache=H,u.LanguageRegistry=I,u.PERFORMANCE_CONFIGS=j,u.SearchCache=x,u.SpanishProcessor=M,u.VERSION=Ce,u.areStringsSimilar=X,u.batchSearch=de,u.buildFuzzyIndex=G,u.calculateDamerauLevenshteinDistance=Y,u.calculateHighlights=_,u.calculateLevenshteinDistance=k,u.calculateNgramSimilarity=L,u.createFuzzySearch=Me,u.deserializeIndex=Q,u.distanceToSimilarity=O,u.formatHighlightedHTML=ge,u.getAccentVariants=fe,u.getSerializedSize=Ee,u.getSuggestions=A,u.hasAccents=he,u.loadIndexFromLocalStorage=Pe,u.mergeConfig=D,u.normalizeForComparison=ue,u.removeAccents=S,u.saveIndexToLocalStorage=Te,u.serializeIndex=F,Object.defineProperty(u,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=fuzzyfindjs.min.js.map
